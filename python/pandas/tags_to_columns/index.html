<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66582-32"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-66582-32');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Transforming Tags into Categorical Data" />
<meta property="og:description" content="I&rsquo;ve encountered a few instances where I need to make clean, dummied data columns from a column that contains a list of attributes. This notebook will go one step further and show an example of generating one such list from a bunch of string fields, generated by concatenating arbitrarily-many &lt;tag&gt; objects together.
An Example In the repo Building Machine Learning Powered Applications, the author has a slick chunk of code that takes a DataFrame containing a column with a bunch of tags (I&rsquo;ve dropped everything else, for simplicity&rsquo;s sake)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://napsterinblue.github.io/notes/python/pandas/tags_to_columns/" />



<meta property="article:published_time" content="2020-10-11T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2020-10-11T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Transforming Tags into Categorical Data"/>
<meta name="twitter:description" content="I&rsquo;ve encountered a few instances where I need to make clean, dummied data columns from a column that contains a list of attributes. This notebook will go one step further and show an example of generating one such list from a bunch of string fields, generated by concatenating arbitrarily-many &lt;tag&gt; objects together.
An Example In the repo Building Machine Learning Powered Applications, the author has a slick chunk of code that takes a DataFrame containing a column with a bunch of tags (I&rsquo;ve dropped everything else, for simplicity&rsquo;s sake)"/>
<meta name="generator" content="Hugo 0.40.3" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Transforming Tags into Categorical Data",
  "url": "https://napsterinblue.github.io/notes/python/pandas/tags_to_columns/",
  "wordCount": "2303",
  "datePublished": "2020-10-11T00:00:00&#43;00:00",
  "dateModified": "2020-10-11T00:00:00&#43;00:00",
  "author": {
    "@type": "Person",
    "name": ""
  }
}
</script> 

    <title>Transforming Tags into Categorical Data</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://napsterinblue.github.io/notes/css/custom.css" rel="stylesheet">
    <link href="https://napsterinblue.github.io/notes/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    <link href="" rel="alternate" type="application/rss+xml" title="Data Science Notes" />

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://napsterinblue.github.io">Movies, Metrics, Musings</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="nav navbar-nav">
                    <li><a href="https://napsterinblue.github.io/pages/about.html" title="About">About</a></li>
                    <li><a href="https://napsterinblue.github.io/archives.html" title="Archive">Archive</a></li>
                    <li><a href="https://napsterinblue.github.io/pages/resources.html" title="Resources">Resources</a></li>
                    <li><a href="https://napsterinblue.github.io/notes/" title="Notes">My Notes</a></li>

                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Transforming Tags into Categorical Data</h1>
    <div class="technical_note_date">
      <time datetime=" 2020-10-11T00:00:00Z "> 11 Oct 2020</time>
    </div>
  </header>
  <div class="content">
  

<p>I&rsquo;ve encountered a few instances where I need to make clean, dummied data columns from a column that contains a list of attributes. This notebook will go one step further and show an example of <em>generating</em> one such list from a bunch of string fields, generated by concatenating arbitrarily-many <code>&lt;tag&gt;</code> objects together.</p>

<h3 id="an-example">An Example</h3>

<p>In <a href="https://github.com/hundredblocks/ml-powered-applications/blob/master/notebooks/tabular_data_vectorization.ipynb">the repo Building Machine Learning Powered Applications</a>, the author has a slick chunk of code that takes a DataFrame containing a column with a bunch of tags (I&rsquo;ve dropped everything else, for simplicity&rsquo;s sake)</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/writers.csv&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Score</th>
      <th>Tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32</td>
      <td>&lt;resources&gt;&lt;first-time-author&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>&lt;fiction&gt;&lt;grammatical-person&gt;&lt;third-person&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>&lt;publishing&gt;&lt;novel&gt;&lt;agent&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28</td>
      <td>&lt;plot&gt;&lt;short-story&gt;&lt;planning&gt;&lt;brainstorming&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>&lt;fiction&gt;&lt;genre&gt;&lt;categories&gt;</td>
    </tr>
  </tbody>
</table>
</div>

<p>and does a bunch of <code>pandas</code> magic to transform it into neat columns of popular tags that they use for their modelling.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Select our tags, represented as strings, and transform them into arrays of tags</span>
<span class="n">tags</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&#34;Tags&#34;</span><span class="p">]</span>
<span class="n">clean_tags</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;&gt;&lt;&#34;</span><span class="p">)</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&#34;&lt;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&#34;&gt;&#34;</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>

<span class="c1"># Use pandas&#39; get_dummies to get dummy values </span>
<span class="c1"># select only tags that appear over 500 times</span>
<span class="n">tag_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">clean_tags</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">all_tags</span> <span class="o">=</span> <span class="n">tag_columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">top_tags</span> <span class="o">=</span> <span class="n">all_tags</span><span class="p">[</span><span class="n">all_tags</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">top_tag_columns</span> <span class="o">=</span> <span class="n">tag_columns</span><span class="p">[</span><span class="n">top_tags</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">top_tag_columns</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Score</th>
      <th>Tags</th>
      <th>creative-writing</th>
      <th>fiction</th>
      <th>style</th>
      <th>characters</th>
      <th>technique</th>
      <th>novel</th>
      <th>publishing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32</td>
      <td>&lt;resources&gt;&lt;first-time-author&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>&lt;fiction&gt;&lt;grammatical-person&gt;&lt;third-person&gt;</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>&lt;publishing&gt;&lt;novel&gt;&lt;agent&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28</td>
      <td>&lt;plot&gt;&lt;short-story&gt;&lt;planning&gt;&lt;brainstorming&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>&lt;fiction&gt;&lt;genre&gt;&lt;categories&gt;</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<p>However, that dense chunk of code is doing a ton, so let&rsquo;s break it down step by step</p>

<h3 id="less-magic">Less Magic</h3>

<p>For starters, they turn the tag strings into lists of strings with a simple <code>apply()</code> call and some <code>&gt;&lt;</code> hunting</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tags</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tags&#39;</span><span class="p">]</span>

<span class="n">clean_tags</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&gt;&lt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">clean_tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<pre><code>0                  [resources, first-time-author]
1     [fiction, grammatical-person, third-person]
2                      [publishing, novel, agent]
3    [plot, short-story, planning, brainstorming]
4                    [fiction, genre, categories]
Name: Tags, dtype: object
</code></pre>

<h4 id="dummying">Dummying</h4>

<p>This next one is a doozy. Just remember that we&rsquo;re trying to go from the list of tags above, to an identity matrix like so.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">tag_columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">clean_tags</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">tag_columns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<p>Step by step, we start by turning these lists into <code>pd.Series</code> objects</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="n">clean_tags</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>resources</td>
      <td>first-time-author</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fiction</td>
      <td>grammatical-person</td>
      <td>third-person</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>publishing</td>
      <td>novel</td>
      <td>agent</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>plot</td>
      <td>short-story</td>
      <td>planning</td>
      <td>brainstorming</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fiction</td>
      <td>genre</td>
      <td>categories</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>There are 5 columns, because that&rsquo;s the most tags that are on any of our observations</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">clean_tags</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">()</span></code></pre></div>
<pre><code>5
</code></pre>

<p>We wanted it in the <code>pd.Series</code> format, so we could call the <code>.stack()</code> method, which tosses out all of the blank <code>NaN</code> records and organizes our records into one multi-index Series</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></div>
<pre><code>0  0             resources
   1     first-time-author
1  0               fiction
   1    grammatical-person
   2          third-person
2  0            publishing
   1                 novel
   2                 agent
3  0                  plot
   1           short-story
dtype: object
</code></pre>

<p>It&rsquo;s not immediately intuitive why we want it in a Series until you look at the next step where we create the categorical columns from the data.</p>

<p>If we leverage this clean, stacked Series, we get something that looks pretty reasonable. Note the <code>330</code> columns.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<p>On the other hand, if we make that same call with <code>a</code> (the <code>NaN</code>-filled DataFrame), we get nearly four times as many columns as our last implementation.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">bad</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">bad</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0_academic-writing</th>
      <th>0_accessibility</th>
      <th>0_acronyms</th>
      <th>0_agent</th>
      <th>0_amazon</th>
      <th>0_antagonist</th>
      <th>0_apa</th>
      <th>0_api-documentation</th>
      <th>0_attention</th>
      <th>0_audiobook</th>
      <th>...</th>
      <th>4_voice</th>
      <th>4_voice-choice</th>
      <th>4_wikipedia</th>
      <th>4_word-choice</th>
      <th>4_wordcount</th>
      <th>4_world-building</th>
      <th>4_writers-block</th>
      <th>4_writing-groups</th>
      <th>4_young-adult</th>
      <th>4_young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1261 columns</p>
</div>

<p>We don&rsquo;t have to worry about <code>pandas</code> accidentally using the <code>NULL</code> data</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;NaN&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span></code></pre></div>
<pre><code>[]
</code></pre>

<p>However, a quick check shows that it is incorrectly placing importance on the column index that it found the data.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;academic&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span></code></pre></div>
<pre><code>['0_academic-writing',
 '1_academic-writing',
 '2_academic-writing',
 '3_academic-writing']
</code></pre>

<p>Moving on, we&rsquo;ve still got this <code>MultiIndex</code> that we&rsquo;ve got no real use for.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">c</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<p>Hence the call to <code>sum(level=0)</code></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<p>We had to specify <code>level=0</code> because we wanted to ensure that our resulting DataFrame still had a row per row of data in our original DataFrame</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code></pre></div>
<pre><code>(7971, 7971)
</code></pre>

<p>Calling <code>c.sum()</code> without any arguments just does a naive sum down the columns</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">wrong_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">wrong_1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<pre><code>3-acts                7
academic-writing    277
accessibility         6
acronyms             15
action                3
dtype: int64
</code></pre>

<p>And so our data is now a Series, for as many columns we had</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wrong_1</span><span class="p">))</span></code></pre></div>
<pre><code>330
</code></pre>

<p>And calling it at <code>level=1</code> uses the second level of the MultiIndex to sum each tag by which order they appear.</p>

<p>Here, <code>3-acts</code> appears as the second tag 3 times, the third once, fourth once, fifth 2 times.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">wrong_2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wrong_2</span><span class="p">))</span>
<span class="n">wrong_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<pre><code>5
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>142.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>105.0</td>
      <td>16.0</td>
      <td>20.0</td>
      <td>0.0</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>99.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>23.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>43.0</td>
      <td>7.0</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>29.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>29.0</td>
      <td>16.0</td>
      <td>22.0</td>
      <td>4.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>15.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>11.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<p>But, now we&rsquo;ve got the neat one-hot representation we were after.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>3-acts</th>
      <th>academic-writing</th>
      <th>accessibility</th>
      <th>acronyms</th>
      <th>action</th>
      <th>administration-guides</th>
      <th>agent</th>
      <th>alternative-history</th>
      <th>amazon</th>
      <th>ambiguity</th>
      <th>...</th>
      <th>word-choice</th>
      <th>wordcount</th>
      <th>world-building</th>
      <th>writer</th>
      <th>writers-block</th>
      <th>writing-competitions</th>
      <th>writing-groups</th>
      <th>writing-instruments</th>
      <th>young-adult</th>
      <th>young-author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 330 columns</p>
</div>

<h4 id="filtering">Filtering</h4>

<p>From here, the author casts the columns as <code>bool</code> (I don&rsquo;t think that was necessary), does a simple sum (didn&rsquo;t need to specify the axis here), and sorts the values from highest to lowest</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">all_tags</span> <span class="o">=</span> <span class="n">tag_columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">all_tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<pre><code>creative-writing    1351
fiction             1253
style                991
characters           609
technique            549
dtype: int64
</code></pre>

<p>Then they specify that they only want to use a Tag as a feature if it&rsquo;s got more than 500 uses</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">top_tags</span> <span class="o">=</span> <span class="n">all_tags</span><span class="p">[</span><span class="n">all_tags</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">top_tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<pre><code>creative-writing    1351
fiction             1253
style                991
characters           609
technique            549
dtype: int64
</code></pre>

<p>This narrows our Tag count from 330 to 7</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_tags</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">top_tags</span><span class="p">))</span></code></pre></div>
<pre><code>330 7
</code></pre>

<p>Finally, they use <code>top_tags.index</code> to get a list of the column names for the tags that meet our criteria, and use that to filter down this intermediate <code>tag_columns</code> DataFrame</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">top_tag_columns</span> <span class="o">=</span> <span class="n">tag_columns</span><span class="p">[</span><span class="n">top_tags</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">top_tag_columns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>creative-writing</th>
      <th>fiction</th>
      <th>style</th>
      <th>characters</th>
      <th>technique</th>
      <th>novel</th>
      <th>publishing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="recombining">Recombining</h4>

<p>Last but not least, they use <code>pd.concat()</code> to staple this dummied tag dataset to our original DataFrame.</p>

<p>Why they used <code>pd.concat()</code> and not <code>df.join()</code> is beyond me, as they both do the trick here.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">top_tag_columns</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Score</th>
      <th>Tags</th>
      <th>creative-writing</th>
      <th>fiction</th>
      <th>style</th>
      <th>characters</th>
      <th>technique</th>
      <th>novel</th>
      <th>publishing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32</td>
      <td>&lt;resources&gt;&lt;first-time-author&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>&lt;fiction&gt;&lt;grammatical-person&gt;&lt;third-person&gt;</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>&lt;publishing&gt;&lt;novel&gt;&lt;agent&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28</td>
      <td>&lt;plot&gt;&lt;short-story&gt;&lt;planning&gt;&lt;brainstorming&gt;</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>&lt;fiction&gt;&lt;genre&gt;&lt;categories&gt;</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/napsterinblue/notes/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/napsterinblue'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 179 pages and is available on <a href="https://github.com/napsterinblue/notes">GitHub</a>. Copyright &copy; NapsterInBlue, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>
